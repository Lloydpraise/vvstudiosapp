<aside id="sidebar" class="w-64 bg-[#14161a] p-6 flex-shrink-0 fixed inset-y-0 left-0 transform -translate-x-full transition-transform duration-300 z-50 lg:relative lg:translate-x-0">
    <div class="flex flex-col items-center space-y-2 mb-8">
        <img src="assets/logo.png" alt="VV Studios Logo" class="w-16 h-16">
        <span class="text-xl font-bold">VV Studios</span>
        <span class="text-sm text-white/60">Client Portal</span>
    </div>
    <nav>
           <script src="theme-toggle.js" defer></script>
    <li class="mb-4">
        <a href="index.html"
            class="flex items-center space-x-3 text-white hover:text-white sidebar-link p-3 rounded-xl transition-colors active">
            <i class="fa-solid fa-briefcase w-5 h-5"></i>
            <span>My Business</span>
            <span class="tooltip">View your business overview and key insights</span>
        </a>
    </li>

    <li class="mb-4">
        <a href="ads_management_dashboard.html"
            class="flex items-center space-x-3 text-white hover:text-white sidebar-link p-3 rounded-xl transition-colors">
            <i class="fa-solid fa-bullhorn w-5 h-5"></i>
            <span>Ads</span>
            <span class="tooltip">Optimize your ad campaigns for maximum ROI!</span>
        </a>
    </li>

    <li class="mb-4">
        <a href="crmlanding.html"
            class="flex items-center space-x-3 text-white hover:text-white sidebar-link p-3 rounded-xl transition-colors">
            <i class="fa-solid fa-handshake w-5 h-5"></i>
            <span>Sales & Follow-Ups</span>
            <span class="tooltip">Track and manage your customers easily</span>
        </a>
    </li>
    <li class="mb-4" id="sidebar-ecommerce-item">
        <a href="ecommerce.html" data-always-allow="true"
            class="flex items-center space-x-3 text-white hover:text-white sidebar-link p-3 rounded-xl transition-colors">
            <i class="fa-solid fa-store w-5 h-5"></i>
            <span>Ecommerce</span>
            <span class="tooltip">Sell products, bundles and offers</span>
        </a>
    </li>

    <li class="mb-4">
        <a href="copilot.html"
            class="flex items-center space-x-3 text-white hover:text-white sidebar-link p-3 rounded-xl transition-colors">
            <i class="fa-solid fa-robot w-5 h-5"></i>
            <span>Business Assistant</span>
            <span class="tooltip">Your AI Copilot that helps you run the business</span>
        </a>
    </li>

    <li class="mb-4" id="messaging-item">
        <button type="button" id="messaging-toggle" aria-expanded="false" class="locked w-full flex items-center space-x-3 text-white/30 hover:text-white sidebar-link p-3 rounded-xl transition-colors">
            <i class="fa-solid fa-comments w-5 h-5"></i>
            <span>Messaging</span>
            <i class="fa-solid fa-chevron-down w-4 h-4 ml-auto transition-transform" id="messaging-chevron"></i>
            <i class="fa-solid fa-lock w-3 h-3 text-white/30 ml-2" id="messaging-lock"></i>
        </button>
        <ul id="messaging-submenu" class="mt-2 hidden space-y-2 pl-3">
            <li>
                <a href="messages.html#view-whatsapp" class="flex items-center space-x-3 text-white/60 hover:text-white p-2 rounded-lg">
                    <i class="fa-brands fa-whatsapp w-4 h-4"></i>
                    <span>WhatsApp</span>
                </a>
            </li>
            <li>
                <a href="messages.html#view-facebook-messenger" class="flex items-center space-x-3 text-white/60 hover:text-white p-2 rounded-lg">
                    <i class="fa-brands fa-facebook w-4 h-4"></i>
                    <span>Facebook</span>
                </a>
            </li>
            <li>
                <a href="messages.html#view-instagram-direct" class="flex items-center space-x-3 text-white/60 hover:text-white p-2 rounded-lg">
                    <i class="fa-brands fa-instagram w-4 h-4"></i>
                    <span>Instagram</span>
                </a>
            </li>
        </ul>
    </li>

    <li class="mb-4">
        <a href="#"
            class="flex items-center space-x-3 text-white/30 hover:text-white sidebar-link p-3 rounded-xl transition-colors">
            <i class="fa-solid fa-arrows-spin w-5 h-5"></i>
            <span>Automations</span>
            <span class="tooltip">Automate your business and save 10+ hours a week!</span>
            <i class="fa-solid fa-lock w-3 h-3 text-white/30 ml-auto"></i>
        </a>
    </li>

    <li class="mb-4">
        <a href="#"
            class="flex items-center space-x-3 text-white/30 hover:text-white sidebar-link p-3 rounded-xl transition-colors">
            <i class="fa-solid fa-gear w-5 h-5"></i>
            <span>Marketing Systems</span>
            <span class="tooltip">Sales and marketing on autopilot!</span>
            <i class="fa-solid fa-lock w-3 h-3 text-white/30 ml-auto"></i>
        </a>
    </li>

    <li class="mb-4">
        <a href="contentcreation.html"
            class="flex items-center space-x-3 text-white hover:text-white sidebar-link p-3 rounded-xl transition-colors">
            <i class="fa-solid fa-pen-nib w-5 h-5"></i>
            <span>Content Creation</span>
        </a>
    </li>


    <li class="mb-4">
        <a href="#"
            class="flex items-center space-x-3 text-white/30 hover:text-white sidebar-link p-3 rounded-xl transition-colors">
            <i class="fa-solid fa-comments w-5 h-5"></i>
            <span>Live Chat</span>
            <span class="tooltip">Engage with customers in real-time!</span>
            <i class="fa-solid fa-lock w-3 h-3 text-white/30 ml-auto"></i>
        </a>
    </li>
</ul>
</nav>
    <div class="p-4 border-t border-white/5">
        <button id="logout-btn" class="w-full py-2 px-4 rounded-lg bg-red-500/10 text-red-400 hover:bg-red-500/20 text-sm font-medium transition-colors">
            <i class="fa-solid fa-sign-out-alt mr-2"></i> Log Out
        </button>
    </div>
</aside>
<script>
// Ensure Ecommerce sidebar item always navigates to `ecommerce.html`
        (function(){
    try {
        function isProOrPremium(){
            try{
                const raw=localStorage.getItem('vvUser');
                if(!raw) return false;
                const u=JSON.parse(raw) || {};

                const pkg=((u.package||u.package_name||u.packageType||u.plan||u.role||'')+'').toLowerCase();
                if (pkg === 'pro' || pkg === 'premium') return true;
                if (u.livechat) return true;

                const features = Array.isArray(u.features) ? u.features : (Array.isArray(u.permissions) ? u.permissions : []);
                if (features.some(f => typeof f === 'string' && ['livechat','messaging','messages','crm'].indexOf(f.toLowerCase()) !== -1)) return true;

                if (Array.isArray(u.products) && u.products.some(p => /messag|livechat/i.test(String(p)))) return true;

                return false;
            }catch(e){return false}
        }

        function vv_evalMessagingUnlock(){
            try {
                const toggle = document.getElementById('messaging-toggle');
                const submenu = document.getElementById('messaging-submenu');
                const chevron = document.getElementById('messaging-chevron');
                const lockIcon = document.getElementById('messaging-lock');
                if (!toggle || !submenu) return;
                if (isProOrPremium()){
                    toggle.classList.remove('locked');
                    toggle.classList.remove('text-white/30');
                    toggle.classList.add('text-white');
                    if (lockIcon) lockIcon.remove();
                    submenu.querySelectorAll('a').forEach(a => { a.classList.remove('text-white/60'); a.classList.add('text-white'); });
                }
            } catch(e) { console.warn('vv_evalMessagingUnlock failed', e); }
        }
        window.vv_evalMessagingUnlock = vv_evalMessagingUnlock;
        const item = document.getElementById('sidebar-ecommerce-item');
        if (!item) return;
        const anchor = item.querySelector('a');
        if (!anchor) return;

        if (!isProOrPremium()) return; // only unlock ecommerce for Pro/Premium

        // Remove any existing lock icon
        const existingLock = anchor.querySelector('.fa-lock');
        if (existingLock) existingLock.remove();

        // Make the link active and point to ecommerce landing
        anchor.classList.remove('text-white/30');
        anchor.classList.add('text-white');
        anchor.setAttribute('href', 'ecommerce.html');
    } catch (err) { console.error(err); }
})();
</script>
<script>
// Messaging submenu toggle
(function(){
    try {
        function isProOrPremium(){ try{ const raw=localStorage.getItem('vvUser'); if(!raw) return false; const u=JSON.parse(raw); const pkg=((u.package||u.package_name||u.packageType||'')+'').toLowerCase(); return pkg==='pro' || pkg==='premium'; }catch(e){return false} }
        const toggle = document.getElementById('messaging-toggle');
        const submenu = document.getElementById('messaging-submenu');
        const chevron = document.getElementById('messaging-chevron');
        const lockIcon = document.getElementById('messaging-lock');
        if (!toggle || !submenu) return;

        // unlock if eligible
        if (isProOrPremium()){
            toggle.classList.remove('locked');
            toggle.classList.remove('text-white/30');
            toggle.classList.add('text-white');
            if (lockIcon) lockIcon.remove();
        }

        toggle.addEventListener('click', function(){
            if (toggle.classList.contains('locked')) return; // ignore if locked
            const expanded = toggle.getAttribute('aria-expanded') === 'true';
            toggle.setAttribute('aria-expanded', String(!expanded));
            submenu.classList.toggle('hidden');
            if (chevron) chevron.classList.toggle('rotate-180');
        });
    } catch (e) { console.error(e); }
})();
</script>
